{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "RepairTheModelSlide",
  "description": "Schema for Repair the Model template - teaches debugging and common mistakes",
  "type": "object",
  "required": ["title", "learningObjective", "enablesNext", "artifactContext", "artifact", "errors", "steps"],
  "properties": {
    "title": {
      "type": "string"
    },
    "learningObjective": {
      "type": "string"
    },
    "enablesNext": {
      "type": "string"
    },
    "artifactContext": {
      "type": "object",
      "required": ["title", "description", "intendedBehavior", "actualBehavior"],
      "properties": {
        "title": { "type": "string" },
        "description": { "type": "string" },
        "intendedBehavior": { "type": "string" },
        "actualBehavior": { "type": "string" }
      }
    },
    "artifact": {
      "type": "object",
      "required": ["type", "buggyContent", "correctContent"],
      "properties": {
        "type": { "enum": ["code", "query", "request", "config", "diagram"] },
        "language": { "enum": ["sql", "python", "javascript", "json", "yaml", "bash"] },
        "buggyContent": { "type": "string" },
        "correctContent": { "type": "string" },
        "filename": { "type": "string" }
      }
    },
    "errors": {
      "type": "array",
      "minItems": 1,
      "items": {
        "type": "object",
        "required": ["id", "lineStart", "description", "explanation", "category", "severity", "correctFix"],
        "properties": {
          "id": { "type": "string" },
          "lineStart": { "type": "number" },
          "lineEnd": { "type": "number" },
          "columnStart": { "type": "number" },
          "columnEnd": { "type": "number" },
          "description": { "type": "string" },
          "explanation": { "type": "string" },
          "category": { "enum": ["syntax", "logic", "semantic", "performance", "security", "best-practice"] },
          "severity": { "enum": ["critical", "error", "warning", "info"] },
          "correctFix": { "type": "string" },
          "commonMistakes": {
            "type": "array",
            "items": {
              "type": "object",
              "properties": {
                "attempt": { "type": "string" },
                "feedback": { "type": "string" }
              }
            }
          }
        }
      }
    },
    "steps": {
      "type": "array",
      "minItems": 1,
      "items": {
        "type": "object",
        "required": ["id", "phase", "title", "instruction", "hints", "requiresAction"],
        "properties": {
          "id": { "type": "string" },
          "phase": { "enum": ["explain", "guided", "construct", "outcome"] },
          "title": { "type": "string" },
          "instruction": { "type": "string" },
          "hints": {
            "type": "array",
            "minItems": 2
          },
          "requiresAction": { "type": "boolean" },
          "relevantErrors": {
            "type": "array",
            "items": { "type": "string" }
          },
          "mode": { "enum": ["identify", "fix", "both"] },
          "expectedIdentifications": {
            "type": "array",
            "items": { "type": "string" }
          },
          "showComparison": { "type": "boolean" }
        }
      }
    },
    "outputPreview": {
      "type": "object",
      "properties": {
        "buggyOutput": { "type": "string" },
        "correctOutput": { "type": "string" },
        "type": { "enum": ["text", "table", "error", "json"] }
      }
    },
    "realWorldImpact": { "type": "string" },
    "completionMessage": { "type": "string" }
  }
}
