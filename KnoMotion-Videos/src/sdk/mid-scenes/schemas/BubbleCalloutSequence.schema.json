{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "BubbleCalloutSequence",
  "description": "Floating speech-bubble callouts with sequential appearance and optional connecting lines",
  "type": "object",
  "required": ["callouts", "beats"],
  "properties": {
    "callouts": {
      "type": "array",
      "description": "Array of callout items",
      "items": {
        "oneOf": [
          {
            "type": "string",
            "description": "Simple text callout"
          },
          {
            "type": "object",
            "required": ["text"],
            "properties": {
              "text": {
                "type": "string",
                "description": "Callout text content"
              },
              "icon": {
                "type": "string",
                "description": "Optional emoji or icon"
              },
              "color": {
                "type": "string",
                "description": "Custom bubble background color"
              },
              "shape": {
                "type": "string",
                "enum": ["speech", "thought", "rounded", "pill", "square", "notebook"],
                "description": "Bubble shape override"
              },
              "position": {
                "type": "object",
                "description": "Custom position as percentages (0-100)",
                "properties": {
                  "x": { "type": "number", "minimum": 0, "maximum": 100 },
                  "y": { "type": "number", "minimum": 0, "maximum": 100 }
                }
              }
            }
          }
        ]
      },
      "minItems": 1
    },
    "bubbleShape": {
      "type": "string",
      "enum": ["speech", "thought", "rounded", "pill", "square", "notebook"],
      "default": "speech",
      "description": "Default bubble shape for all callouts. 'notebook' has dashed border for Knode style."
    },
    "pattern": {
      "type": "string",
      "enum": ["flow", "vertical", "horizontal", "diagonal", "zigzag", "scattered", "grid", "arc"],
      "default": "flow",
      "description": "Layout pattern for bubble positioning. All patterns now work correctly."
    },
    "animation": {
      "type": "string",
      "enum": ["pop", "float", "slide", "scale", "fade", "drop"],
      "default": "float",
      "description": "Animation type for bubble entrance. 'drop' falls from above."
    },
    "staggerDelay": {
      "type": "number",
      "default": 0.3,
      "minimum": 0,
      "description": "Delay between callouts in seconds"
    },
    "animationDuration": {
      "type": "number",
      "default": 0.6,
      "minimum": 0.1,
      "description": "Animation duration per callout in seconds"
    },
    "showConnectors": {
      "type": "boolean",
      "default": false,
      "description": "Show connecting lines between callouts"
    },
    "connectorStyle": {
      "type": "string",
      "enum": ["solid", "dashed", "dotted"],
      "default": "dashed",
      "description": "Style of connecting lines"
    },
    "bubbleColor": {
      "type": "string",
      "default": "cardBg",
      "description": "Default bubble background color. Theme keys: cardBg, pageBg, primary, secondary. Or hex/rgb."
    },
    "textColor": {
      "type": "string",
      "default": "textMain",
      "description": "Default text color. Theme keys: textMain, textSoft, textMuted. Or hex/rgb."
    },
    "beats": {
      "type": "object",
      "required": ["start"],
      "properties": {
        "start": {
          "type": "number",
          "description": "Start time in seconds"
        }
      }
    },
    "position": {
      "type": "object",
      "description": "Slot position from layout resolver",
      "properties": {
        "left": { "type": "number" },
        "top": { "type": "number" },
        "width": { "type": "number" },
        "height": { "type": "number" }
      }
    },
    "style": {
      "type": "object",
      "description": "Optional style overrides",
      "properties": {
        "bubbleWrapper": { "type": "object" },
        "bubble": { "type": "object" },
        "content": { "type": "object" },
        "icon": { "type": "object" },
        "text": { "type": "object" }
      }
    }
  },
  "examples": [
    {
      "callouts": [
        { "text": "Start with a clear goal", "icon": "üéØ" },
        { "text": "Break into small steps", "icon": "üìù" },
        { "text": "Celebrate progress!", "icon": "üéâ" }
      ],
      "bubbleShape": "speech",
      "pattern": "diagonal",
      "animation": "float",
      "showConnectors": true,
      "staggerDelay": 0.4,
      "beats": { "start": 1.0 }
    },
    {
      "callouts": [
        { "text": "What if we tried something new?", "shape": "thought" },
        { "text": "That's a great idea!", "shape": "speech" },
        { "text": "Let's make it happen!", "shape": "rounded" }
      ],
      "pattern": "zigzag",
      "animation": "pop",
      "beats": { "start": 0.5 }
    },
    {
      "callouts": [
        { "text": "Step 1: Learn", "icon": "üìö" },
        { "text": "Step 2: Practice", "icon": "üí™" },
        { "text": "Step 3: Apply", "icon": "üéØ" },
        { "text": "Step 4: Share", "icon": "üåü" }
      ],
      "bubbleShape": "notebook",
      "pattern": "grid",
      "animation": "drop",
      "beats": { "start": 1.0 }
    },
    {
      "callouts": [
        { "text": "Feature A", "position": { "x": 20, "y": 30 } },
        { "text": "Feature B", "position": { "x": 80, "y": 30 } },
        { "text": "Feature C", "position": { "x": 50, "y": 70 } }
      ],
      "bubbleShape": "pill",
      "animation": "scale",
      "beats": { "start": 0.5 }
    }
  ],
  "patternDescriptions": {
    "flow": "Vertical centered with slight horizontal alternation",
    "vertical": "Evenly spaced vertical stack, centered horizontally",
    "horizontal": "Evenly spaced horizontal row, centered vertically",
    "diagonal": "Top-left to bottom-right diagonal progression",
    "zigzag": "Alternating left-right positions vertically",
    "scattered": "Deterministic scatter using golden angle distribution",
    "grid": "Auto-calculated grid layout based on callout count",
    "arc": "Semi-circular arc from left to right"
  },
  "sizingBehavior": {
    "description": "BubbleCalloutSequence adapts to slot dimensions",
    "width": "Bubbles are sized up to 50% of slot width or 350px max",
    "height": "Bubbles are distributed within slot height based on pattern",
    "fontScaling": "Font size scales based on callout count and slot height (14-22px)",
    "positioning": "Bubbles can use auto-layout patterns or custom percentage positions"
  }
}
